<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Coprime probabilities | Don&#39;t Panic!</title>
  <meta name="author" content="Farseer He">
  
  <meta name="description" content="A Conclusion听说了一个有趣的结论：两个随机的正整数互质的概率为 $\frac{6}{\pi ^2}$，对它的推导过程感到好奇，于是通过wikipedia学习了一些数学知识…
Basic Analysis何为“两个随机正整数”？正整数集合的度是无穷大，所以要使得所有整数对出现的概率相同是无法达到的。
问题需要如此描述：我们用 $Z_2(t)$ 表示互质整数对的个数，其中每个整数对中的两个整数都不大于t，于是所要求的概率即为 $limit_{t \to \infty} \frac{Z_2(t)}{t ^2} $。
我们忽略这个定义，直接考虑无穷的情形，两个整数互质，说明对任意的质数p，它们不能同时被p整除；一个随机正整数被p整除的概率为$1/p$，于是它们不同时被p整除的概率为$1-1/p ^2$，对于不同的质数p，相互独立；于是所求即为：
$$\prod\limits_{prime\ p} (1-1/p ^2)\tag{1}\label{eq1}$$.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Coprime probabilities"/>
  <meta property="og:site_name" content="Don&#39;t Panic!"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Don&#39;t Panic!" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-40313156-5', 'auto');
	ga('send', 'pageview');

</script>


</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Don&#39;t Panic!</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-06-27T16:00:00.000Z"><a href="/2015/06/28/coprime-probabilities/">2015-06-28</a></time>
      
      
  
    <h1 class="title">Coprime probabilities</h1>
  

    </header>
    <div class="entry">
      
        <h2 id="A-Conclusion"><a href="#A-Conclusion" class="headerlink" title="A Conclusion"></a>A Conclusion</h2><p>听说了一个有趣的结论：两个随机的正整数互质的概率为 $\frac{6}{\pi ^2}$，对它的推导过程感到好奇，于是通过wikipedia学习了一些数学知识…</p>
<h2 id="Basic-Analysis"><a href="#Basic-Analysis" class="headerlink" title="Basic Analysis"></a>Basic Analysis</h2><p>何为“两个随机正整数”？正整数集合的度是无穷大，所以要使得所有整数对出现的概率相同是无法达到的。</p>
<p>问题需要如此描述：我们用 $Z_2(t)$ 表示互质整数对的个数，其中每个整数对中的两个整数都不大于t，于是所要求的概率即为 $limit_{t \to \infty} \frac{Z_2(t)}{t ^2} $。</p>
<p>我们忽略这个定义，直接考虑无穷的情形，两个整数互质，说明对任意的质数p，它们不能同时被p整除；一个随机正整数被p整除的概率为$1/p$，于是它们不同时被p整除的概率为$1-1/p ^2$，对于不同的质数p，相互独立；于是所求即为：</p>
<p>$$<br>\prod\limits_{prime\ p} (1-1/p ^2)\tag{1}\label{eq1}<br>$$.</p>
<a id="more"></a>
<p>更加严密地，我们有 $t ^k = \sum\limits_{d | t} Z_k(t/d)$，等式左边为k元正整数向量的个数（所有成员不大于t），右边为所有k个正整数最大公约数为d时的个数（gcd为d时，若将所有整数除以d，得到的向量正是$Z_k(t/d)中的一员，即每个数不大于t/d，且gcd为1。这是一个同构关系$）。</p>
<p>对上式进行 Möbius 反演变换，得到 $Z_k(t) = \sum\limits_{d | t} \mu(d)(t/d) ^k$，于是$\frac{Z_k(t)}{t ^k} = \sum\limits_{d | t} \frac{\mu(d)}{d ^k}$，于是当 $t \to \infty$ 时，所求为：</p>
<p>$$<br>\sum\limits_{d = 1} ^{\infty} \frac{\mu(d)}{d ^k} = \frac{1}{\zeta(k)}\tag{2}\label{eq2}<br>$$</p>
<p>zeta函数的定义以及该等式的证明见下文。</p>
<h2 id="Riemann-Zeta-Function"><a href="#Riemann-Zeta-Function" class="headerlink" title="Riemann Zeta Function"></a>Riemann Zeta Function</h2><p>黎曼Zeta函数是一个知名函数，在数论，物理等多个领域有广泛的应用。<br>定义如下 $\zeta(s) = \sum\limits_{n=1} ^{\infty} \frac{1}{n ^s}$，接下来我们证明：</p>
<p>$$<br>\zeta(s) = \prod\limits_{prime\ p} \frac{1}{1-p ^{-s}}\tag{3}\label{eq3}<br>$$</p>
<p>从而可以推出，<code>随机k个正整数的gcd为1的概率为</code> $1/\zeta(k)$.（通过类似于$\eqref{eq1}$的分析过程）</p>
<p>该结论称为 “Euler product formula for the Riemann zeta function”. 事实它对复数域上的s，在满足s的实部大于1的时候均成立，我在这不求甚解，只关心s为整数的情况。先来看下欧拉给出的符合直觉的证明，该证明只用到了初等数学的知识，非常的直接。</p>
<p>$$<br>\zeta(s) = 1 + 1/2 ^s + 1/3 ^s + 1/4 ^s \cdots \\<br>\zeta(s)/2 ^s = 1/2 ^s + 1/4 ^s + 1/6 ^s + 1/8 ^s \cdots \\<br>(1-1/2 ^s)\zeta(s) = 1 + 1/3 ^s + 1/5 ^s + 1/7 ^s \cdots \\<br>(1-1/2 ^s)/3 ^s \zeta(s) = 1/3 ^s + 1/9 ^s + 1/15 ^s \cdots \\<br>(1-1/2 ^s)(1-1/3 ^s) \zeta(s) = 1 + 1/5 ^s + 1/7 ^s + 1/11 ^s \cdots \\<br>\vdots \\<br>\prod\limits_{prime\ p} (1-p ^s) \zeta(s) = 1<br>$$</p>
<h2 id="Dirichlet-Series"><a href="#Dirichlet-Series" class="headerlink" title="Dirichlet Series"></a>Dirichlet Series</h2><p>狄力克雷级数与黎曼Zeta函数有密切的联系，我们可以通过它的相关理论证明一些重要的结论。<br>其定义如下：</p>
<p>$$<br>\mathfrak{D}^{A}_w(s) = \sum\limits_{a \in A} \frac{1}{w(a) ^s} = \sum\limits_{n=1} ^{\infty} \frac{a_n}{n ^s}.<br>$$</p>
<p>其中A为一个集合，w为一个$A \to \mathbb{N}$的函数，它满足如下的运算规则：</p>
<p>$$<br>A \cap B = \varnothing \rightarrow \\<br>\mathfrak{D}^{A \uplus B}_w(s) = \mathfrak{D}^{A}_w(s) + \mathfrak{D}^{B}_w(s) \\<br>\forall (a, b) \in A \times B, w(a,b) = u(a)v(b) \rightarrow \\<br>\mathfrak{D}^{A \times B}_w(s) = \mathfrak{D}^{A}_u(s) \cdot \mathfrak{D}^{B}_v(s)<br>$$</p>
<p>这两个运算规则也很符合直觉，类似多项式展开… 利用这两个定理， “Euler product formula for the Riemann zeta function” 可以这样证明：</p>
<p>$$<br>\zeta(s) = \mathfrak{D}^{\mathbb{N}}_{\mathrm{id}}(s) = \prod\limits_{prime\ p}<br>\mathfrak{D}^{\{p ^n : n \in \mathbb{N}\}}_{\mathrm{id}}(s) = \prod_{prime\ p} \sum_{n \in \mathbb{N}} \mathfrak{D}^{\{p ^n\}}_{\mathrm{id}}(s) \\<br>= \prod\limits_{prime\ p} \sum\limits_{n \in \mathbb{N}} \frac{1}{(p ^n) ^s}<br>= \prod\limits_{prime\ p} \sum\limits_{n \in \mathbb{N}} \left(\frac{1}{p ^s}\right) ^n<br>= \prod_{prime\ p} \frac{1}{1-p ^{-s}}<br>$$</p>
<p>就是说将所有的正整进行质因数分解，于是得到正整数到一个质因数指数向量的一一映射，正整数集合便可以表示成无穷个质数幂次集合的笛卡尔积…</p>
<h3 id="Dirichlet-Convolution"><a href="#Dirichlet-Convolution" class="headerlink" title="Dirichlet Convolution"></a>Dirichlet Convolution</h3><p>我们可以通过狄力克雷卷积证明结论$\eqref{eq2}$。</p>
<p>可以用另一种方式表示狄力克雷级数：$DG(f, s) = \sum\limits_{n=1}^{\infty} \frac{f(n)}{n ^s}$.<br>定义卷积如下 $(f * g)(n) = \sum\limits_{d|n}f(d)g(n/d)$，可以得到卷积公式如下：</p>
<p>$$<br>DG(f, s) \cdot DG(g, s) = DG(f * g, s)\tag{4}<br>$$</p>
<p>将定义直接带入，展开，右边的每一项在左边出现且仅出现一次。<br>根据这条定理我们有：</p>
<p>$$<br>\zeta(s) \cdot \sum\limits_{n=1}^{\infty}\frac{\mu(n)}{n ^s} =<br>DG(1, s) \cdot DG(\mu, s) = DG(1 * \mu, s) =<br>\sum\limits_{n=1}^{\infty}\frac{\sum\limits_{d|n}\mu(d)}{n ^s} = 1<br>$$</p>
<p>注意到上式右边的通项分子满足：</p>
<p>$$<br>\sum\limits_{d|n}\mu(d) =<br> \begin{cases}<br>    1 &amp;\mbox{n = 1} \\<br>    0 &amp;\mbox{n &gt; 1}<br>\end{cases}<br>$$</p>
<h2 id="Basel-Problem"><a href="#Basel-Problem" class="headerlink" title="Basel Problem"></a>Basel Problem</h2><p>事实上要求原问题的解，根据公式$\eqref{eq3}$以及其推论，我们只需要计算$\zeta(2)$即可，之所以用Möbius反演绕了一圈，其实只是为了将几个著名的结论串在一起，以揭示其内在联系。最终我们还是无法避免地需要求这个级数和。</p>
<h3 id="Euler’s-Approach"><a href="#Euler’s-Approach" class="headerlink" title="Euler’s Approach"></a>Euler’s Approach</h3><p>这个问题最早由欧拉解决，考虑sin(x)的泰勒展开，得到：</p>
<p>$$<br>\frac{sin(x)}{x} = 1 - x ^2/3! + x ^4/5! - x ^6/7! + \cdots \tag{5}\label{eq5}<br>$$</p>
<p>又，根据 “Weierstrass factorization theorem”, 有：</p>
<p>$$<br>\frac{sin(x)}{x} = (1-\frac{x}{\pi})(1+\frac{x}{\pi})(1-\frac{x}{2\pi})(1+\frac{x}{2\pi})(1-\frac{x}{3\pi})(1+\frac{x}{3\pi})\cdots \\<br>= (1-\frac{x ^2}{\pi ^2})(1-\frac{x ^2}{4\pi ^2})(1-\frac{x ^2}{9\pi ^2})\cdots \tag{6}\label{eq6}<br>$$</p>
<p>其实就是因式分解，只不过是在复数域上进行。比较 $\eqref{eq5}, \eqref{eq6}$ 中的二次项系数，容易得出：$\zeta(2) = \sum\limits_{n=1}^{\infty} 1/n ^2 = \pi ^2/6$</p>
<h3 id="Other-Approaches"><a href="#Other-Approaches" class="headerlink" title="Other Approaches"></a>Other Approaches</h3><p>wikipedia还给出了三种解法，分别是：</p>
<ul>
<li>利用zeta函数和 <a href="https://en.wikipedia.org/wiki/Bernoulli_number" target="_blank" rel="external">Bernoulli number</a> 的关系公式 $\zeta(2n) = \frac{(2\pi)^{2n}(-1)^{n+1} B_{2n}}{2\cdot(2n)!}$</li>
<li>通过对 $f(x) = 2 \sum\limits_{n=1}^{\infty}\frac{(-1)^{n+1}}{n} sin(nx)$ 进行傅里叶变换，然后通过 <a href="https://en.wikipedia.org/wiki/Parseval&#39;s_identity" target="_blank" rel="external">Parseval’s identity</a>（如果没记错的话也叫能量公式）求值</li>
<li>通过不等式夹逼</li>
</ul>
<p>具体的解法见参考链接。</p>
<h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><p>一个简单的数学问题可以将诸多著名的结论联系起来，贯穿了数论，概率论，数学分析，复变等多个分支；而wikipedia的内容组织形式以及其足够的专业度让我可以完全在站内找到我所需要的答案。</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a href="https://en.wikipedia.org/wiki/Möbius_inversion_formula" target="_blank" rel="external">Möbius inversion formula</a></li>
<li><a href="https://en.wikipedia.org/wiki/Proof_of_the_Euler_product_formula_for_the_Riemann_zeta_function" target="_blank" rel="external">Proof of the Euler product formula for the Riemann zeta function</a></li>
<li><a href="https://en.wikipedia.org/wiki/Dirichlet_series" target="_blank" rel="external">Dirichlet series</a></li>
<li><a href="https://en.wikipedia.org/wiki/Dirichlet_convolution" target="_blank" rel="external">Dirichlet convolution</a></li>
<li><a href="https://en.wikipedia.org/wiki/Basel_problem" target="_blank" rel="external">Basel problem</a></li>
<li><a href="https://en.wikipedia.org/wiki/Bernoulli_number" target="_blank" rel="external">Bernoulli number</a></li>
<li><a href="https://en.wikipedia.org/wiki/Parseval&#39;s_identity" target="_blank" rel="external">Parseval’s identity</a></li>
<li><a href="https://en.wikipedia.org/wiki/Weierstrass_factorization_theorem" target="_blank" rel="external">Weierstrass factorization theorem</a></li>
<li><a href="https://en.wikipedia.org/wiki/Coprime_integers" target="_blank" rel="external">Coprime integers</a></li>
</ul>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/fun/">fun</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/math/">math</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
    
      <a class="addthis_button_tweet"></a>
    
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">Comments</h1>

  
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:farseer.cn">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/PLT/">PLT</a><small>4</small></li>
  
    <li><a href="/categories/PRML/">PRML</a><small>4</small></li>
  
    <li><a href="/categories/TCS/">TCS</a><small>2</small></li>
  
    <li><a href="/categories/fun/">fun</a><small>4</small></li>
  
    <li><a href="/categories/notes/">notes</a><small>1</small></li>
  
    <li><a href="/categories/tips/">tips</a><small>2</small></li>
  
    <li><a href="/categories/tweak/">tweak</a><small>3</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/Coq/">Coq</a><small>1</small></li>
  
    <li><a href="/tags/EVA/">EVA</a><small>1</small></li>
  
    <li><a href="/tags/Information-theory/">Information theory</a><small>2</small></li>
  
    <li><a href="/tags/art/">art</a><small>1</small></li>
  
    <li><a href="/tags/distributed/">distributed</a><small>2</small></li>
  
    <li><a href="/tags/game/">game</a><small>1</small></li>
  
    <li><a href="/tags/haskell/">haskell</a><small>2</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>2</small></li>
  
    <li><a href="/tags/lambda-calculus/">lambda-calculus</a><small>2</small></li>
  
    <li><a href="/tags/logic/">logic</a><small>2</small></li>
  
    <li><a href="/tags/math/">math</a><small>4</small></li>
  
    <li><a href="/tags/ml/">ml</a><small>4</small></li>
  
    <li><a href="/tags/paper/">paper</a><small>2</small></li>
  
    <li><a href="/tags/physics/">physics</a><small>1</small></li>
  
    <li><a href="/tags/scala/">scala</a><small>1</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>1</small></li>
  
    <li><a href="/tags/spark/">spark</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>2</small></li>
  
    <li><a href="/tags/vimperator/">vimperator</a><small>3</small></li>
  
    <li><a href="/tags/zsh/">zsh</a><small>1</small></li>
  
    <li><a href="/tags/ツッコミ/">ツッコミ</a><small>1</small></li>
  
    <li><a href="/tags/中二病/">中二病</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 Farseer He
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'githubio';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
</body>
</html>